ARM GAS  C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s 			page 1


   1              		.cpu cortex-m4
   2              		.arch armv7e-m
   3              		.fpu fpv4-sp-d16
   4              		.eabi_attribute 27, 1
   5              		.eabi_attribute 28, 1
   6              		.eabi_attribute 20, 1
   7              		.eabi_attribute 21, 1
   8              		.eabi_attribute 23, 3
   9              		.eabi_attribute 24, 1
  10              		.eabi_attribute 25, 1
  11              		.eabi_attribute 26, 1
  12              		.eabi_attribute 30, 1
  13              		.eabi_attribute 34, 1
  14              		.eabi_attribute 18, 4
  15              		.file	"chassis.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.file 1 "application/chassis/chassis.c"
  20              		.section	.text.MecanumCalculate,"ax",%progbits
  21              		.align	1
  22              		.syntax unified
  23              		.thumb
  24              		.thumb_func
  26              	MecanumCalculate:
  27              	.LFB168:
   1:application/chassis/chassis.c **** #include "chassis.h"
   2:application/chassis/chassis.c **** #include "robot_def.h"
   3:application/chassis/chassis.c **** #include "dji_motor.h"
   4:application/chassis/chassis.c **** #include "general_def.h"
   5:application/chassis/chassis.c **** #include "bsp_dwt.h"
   6:application/chassis/chassis.c **** #include "message_center.h"
   7:application/chassis/chassis.c **** #include "ins_task.h"
   8:application/chassis/chassis.c **** #include "arm_math.h"
   9:application/chassis/chassis.c **** /* Ê†πÊçÆrobot_def.h‰∏≠ÁöÑmacroËá™Âä®ËÆ°ÁÆóÁöÑÂèÇÊï∞ */
  10:application/chassis/chassis.c **** #define HALF_WHEEL_BASE (WHEEL_BASE / 2.0f)     // ÂçäËΩ¥Ë∑ù
  11:application/chassis/chassis.c **** #define HALF_TRACK_WIDTH (TRACK_WIDTH / 2.0f)   // ÂçäËΩÆË∑ù
  12:application/chassis/chassis.c **** #define PERIMETER_WHEEL (RADIUS_WHEEL * 2 * PI) // ËΩÆÂ≠êÂë®Èïø
  13:application/chassis/chassis.c **** 
  14:application/chassis/chassis.c **** /* ÁßÅÊúâÂáΩÊï∞ËÆ°ÁÆóÁöÑ‰∏≠‰ªãÂèòÈáè,ËÆæ‰∏∫ÈùôÊÄÅÈÅøÂÖçÂèÇÊï∞‰º†ÈÄíÁöÑÂºÄÈîÄ */
  15:application/chassis/chassis.c **** static float chassis_vx, chassis_vy;     // Â∞Ü‰∫ëÂè∞Á≥ªÁöÑÈÄüÂ∫¶ÊäïÂΩ±Âà∞Â∫ïÁõò
  16:application/chassis/chassis.c **** static float vt_lf, vt_rf, vt_lb, vt_rb; // Â∫ïÁõòÈÄüÂ∫¶Ëß£ÁÆóÂêéÁöÑ‰∏¥Êó∂ËæìÂá∫,ÂæÖËøõË°åÈôêÂπÖ
  17:application/chassis/chassis.c **** 
  18:application/chassis/chassis.c **** #ifdef ONE_BOARD
  19:application/chassis/chassis.c **** static Publisher_t *chassis_pub;                    // Áî®‰∫éÂèëÂ∏ÉÂ∫ïÁõòÁöÑÊï∞ÊçÆ
  20:application/chassis/chassis.c **** static Subscriber_t *chassis_sub;                   // Áî®‰∫éËÆ¢ÈòÖÂ∫ïÁõòÁöÑÊéßÂà∂ÂëΩ‰ª§
  21:application/chassis/chassis.c **** #endif                                              // !ONE_BOARD
  22:application/chassis/chassis.c **** static Chassis_Ctrl_Cmd_s chassis_cmd_recv;         // Â∫ïÁõòÊé•Êî∂Âà∞ÁöÑÊéßÂà∂ÂëΩ‰ª§
  23:application/chassis/chassis.c **** static Chassis_Upload_Data_s chassis_feedback_data; // Â∫ïÁõòÂõû‰º†ÁöÑÂèçÈ¶àÊï∞ÊçÆ
  24:application/chassis/chassis.c **** static PIDInstance chassis_angle_pid;                     // Â∫ïÁõòÁöÑPIDÊéßÂà∂Âô®
  25:application/chassis/chassis.c **** // static PIDInstance chassis_speed_pid;                      // Â∫ïÁõòÁöÑPIDÊéßÂà∂Âô®
  26:application/chassis/chassis.c **** 
  27:application/chassis/chassis.c **** static DJIMotorInstance *motor_lf, *motor_rf, *motor_lb, *motor_rb; // left right forward back
  28:application/chassis/chassis.c ****  
  29:application/chassis/chassis.c **** void ChassisInit()
  30:application/chassis/chassis.c **** {       //Â∫ïÁõòËßíÂ∫¶ÁéØpidÂàùÂßãÂåñ
  31:application/chassis/chassis.c ****         chassis_angle_pid.Kp=30;
ARM GAS  C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s 			page 2


  32:application/chassis/chassis.c ****         chassis_angle_pid.Ki=2  ;   
  33:application/chassis/chassis.c ****         chassis_angle_pid.Kd=0.05;
  34:application/chassis/chassis.c ****         chassis_angle_pid.IntegralLimit = 3000;
  35:application/chassis/chassis.c ****         chassis_angle_pid.MaxOut = 12000;
  36:application/chassis/chassis.c ****     // Âõõ‰∏™ËΩÆÂ≠êÁöÑÂèÇÊï∞‰∏ÄÊ†∑,Êîπtx_idÂíåÂèçËΩ¨Ê†áÂøó‰ΩçÂç≥ÂèØ
  37:application/chassis/chassis.c ****     Motor_Init_Config_s chassis_motor_config = {
  38:application/chassis/chassis.c ****         .can_init_config.can_handle = &hcan1,
  39:application/chassis/chassis.c ****         .controller_param_init_config = {
  40:application/chassis/chassis.c ****             .speed_PID = {
  41:application/chassis/chassis.c ****                 .Kp = 10, // 4.5
  42:application/chassis/chassis.c ****                 .Ki = 0,  // 0
  43:application/chassis/chassis.c ****                 .Kd = 0,  // 0
  44:application/chassis/chassis.c ****                 .IntegralLimit = 3000,
  45:application/chassis/chassis.c ****                 .Improve = PID_Trapezoid_Intergral | PID_Integral_Limit | PID_Derivative_On_Measure
  46:application/chassis/chassis.c ****                 .MaxOut = 12000,
  47:application/chassis/chassis.c ****             },
  48:application/chassis/chassis.c ****             .current_PID = {
  49:application/chassis/chassis.c ****                 .Kp = 0.5, // 0.4
  50:application/chassis/chassis.c ****                 .Ki = 0,   // 0
  51:application/chassis/chassis.c ****                 .Kd = 0,
  52:application/chassis/chassis.c ****                 .IntegralLimit = 3000,
  53:application/chassis/chassis.c ****                 .Improve = PID_Trapezoid_Intergral | PID_Integral_Limit | PID_Derivative_On_Measure
  54:application/chassis/chassis.c ****                 .MaxOut = 15000,
  55:application/chassis/chassis.c ****             },
  56:application/chassis/chassis.c ****         },
  57:application/chassis/chassis.c ****         .controller_setting_init_config = {
  58:application/chassis/chassis.c ****             .angle_feedback_source = MOTOR_FEED,
  59:application/chassis/chassis.c ****             .speed_feedback_source = MOTOR_FEED,
  60:application/chassis/chassis.c ****             .outer_loop_type = SPEED_LOOP,
  61:application/chassis/chassis.c ****             .close_loop_type = SPEED_LOOP | CURRENT_LOOP,
  62:application/chassis/chassis.c ****         },
  63:application/chassis/chassis.c ****         .motor_type = M3508,
  64:application/chassis/chassis.c ****     };
  65:application/chassis/chassis.c ****     //  @todo: ÂΩìÂâçËøòÊ≤°ÊúâËÆæÁΩÆÁîµÊú∫ÁöÑÊ≠£ÂèçËΩ¨,‰ªçÁÑ∂ÈúÄË¶ÅÊâãÂä®Ê∑ªÂä†referenceÁöÑÊ≠£Ë¥üÂè
  66:application/chassis/chassis.c ****     chassis_motor_config.can_init_config.tx_id = 1;
  67:application/chassis/chassis.c ****     chassis_motor_config.controller_setting_init_config.motor_reverse_flag = MOTOR_DIRECTION_REVERS
  68:application/chassis/chassis.c ****     motor_lf = DJIMotorInit(&chassis_motor_config);
  69:application/chassis/chassis.c **** 
  70:application/chassis/chassis.c ****     chassis_motor_config.can_init_config.tx_id = 2;
  71:application/chassis/chassis.c ****     chassis_motor_config.controller_setting_init_config.motor_reverse_flag = MOTOR_DIRECTION_REVERS
  72:application/chassis/chassis.c ****     motor_rf = DJIMotorInit(&chassis_motor_config);
  73:application/chassis/chassis.c **** 
  74:application/chassis/chassis.c ****     chassis_motor_config.can_init_config.tx_id = 4;
  75:application/chassis/chassis.c ****     chassis_motor_config.controller_setting_init_config.motor_reverse_flag = MOTOR_DIRECTION_REVERS
  76:application/chassis/chassis.c ****     motor_lb = DJIMotorInit(&chassis_motor_config);
  77:application/chassis/chassis.c **** 
  78:application/chassis/chassis.c ****     chassis_motor_config.can_init_config.tx_id = 3;
  79:application/chassis/chassis.c ****     chassis_motor_config.controller_setting_init_config.motor_reverse_flag = MOTOR_DIRECTION_REVERS
  80:application/chassis/chassis.c ****     motor_rb = DJIMotorInit(&chassis_motor_config);
  81:application/chassis/chassis.c **** 
  82:application/chassis/chassis.c ****    
  83:application/chassis/chassis.c **** #ifdef CHASSIS_BOARD
  84:application/chassis/chassis.c ****     Chassis_IMU_data = INS_Init(); // Â∫ïÁõòIMUÂàùÂßãÂåñ
  85:application/chassis/chassis.c **** 
  86:application/chassis/chassis.c ****     CANComm_Init_Config_s comm_conf = {
  87:application/chassis/chassis.c ****         .can_config = {
  88:application/chassis/chassis.c ****             .can_handle = &hcan2,
ARM GAS  C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s 			page 3


  89:application/chassis/chassis.c ****             .tx_id = 0x311, 
  90:application/chassis/chassis.c ****             .rx_id = 0x312,
  91:application/chassis/chassis.c ****         },
  92:application/chassis/chassis.c ****         .recv_data_len = sizeof(Chassis_Ctrl_Cmd_s),
  93:application/chassis/chassis.c ****         .send_data_len = sizeof(Chassis_Upload_Data_s),
  94:application/chassis/chassis.c ****     };
  95:application/chassis/chassis.c ****     chasiss_can_comm = CANCommInit(&comm_conf); // can commÂàùÂßãÂåñ
  96:application/chassis/chassis.c **** #endif                                          // CHASSIS_BOARD
  97:application/chassis/chassis.c **** 
  98:application/chassis/chassis.c **** #ifdef ONE_BOARD // ÂçïÊùøÊéßÂà∂Êï¥ËΩ¶,ÂàôÈÄöËøápubsubÊù•‰º†ÈÄíÊ∂àÊÅØ
  99:application/chassis/chassis.c ****     chassis_sub = SubRegister("chassis_cmd", sizeof(Chassis_Ctrl_Cmd_s));
 100:application/chassis/chassis.c ****     chassis_pub = PubRegister("chassis_feed", sizeof(Chassis_Upload_Data_s));
 101:application/chassis/chassis.c **** #endif // ONE_BOARD
 102:application/chassis/chassis.c **** }
 103:application/chassis/chassis.c **** #define LF_CENTER ((HALF_TRACK_WIDTH + CENTER_GIMBAL_OFFSET_X + HALF_WHEEL_BASE - CENTER_GIMBAL_OFF
 104:application/chassis/chassis.c **** #define RF_CENTER ((HALF_TRACK_WIDTH - CENTER_GIMBAL_OFFSET_X + HALF_WHEEL_BASE - CENTER_GIMBAL_OFF
 105:application/chassis/chassis.c **** #define LB_CENTER ((HALF_TRACK_WIDTH + CENTER_GIMBAL_OFFSET_X + HALF_WHEEL_BASE + CENTER_GIMBAL_OFF
 106:application/chassis/chassis.c **** #define RB_CENTER ((HALF_TRACK_WIDTH - CENTER_GIMBAL_OFFSET_X + HALF_WHEEL_BASE + CENTER_GIMBAL_OFF
 107:application/chassis/chassis.c **** /**
 108:application/chassis/chassis.c ****  * @brief ËÆ°ÁÆóÊØè‰∏™ËΩÆÊØÇÁîµÊú∫ÁöÑËæìÂá∫,Ê≠£ËøêÂä®Â≠¶Ëß£ÁÆó
 109:application/chassis/chassis.c ****  *        Áî®ÂÆèËøõË°åÈ¢ÑÊõøÊç¢ÂáèÂ∞èÂºÄÈîÄ,ËøêÂä®Ëß£ÁÆóÂÖ∑‰ΩìËøáÁ®ãÂèÇËÄÉÊïôÁ®ã
 110:application/chassis/chassis.c ****  */
 111:application/chassis/chassis.c **** static void MecanumCalculate()
 112:application/chassis/chassis.c **** {  
  28              		.loc 1 112 1 view -0
  29              		.cfi_startproc
  30              		@ args = 0, pretend = 0, frame = 0
  31              		@ frame_needed = 0, uses_anonymous_args = 0
  32              		@ link register save eliminated.
 113:application/chassis/chassis.c ****     // vt_lf = -chassis_vx - chassis_vy - chassis_cmd_recv.wz * LF_CENTER;
 114:application/chassis/chassis.c ****     // vt_rf = -chassis_vx + chassis_vy - chassis_cmd_recv.wz * RF_CENTER;
 115:application/chassis/chassis.c ****     // vt_lb = chassis_vx - chassis_vy - chassis_cmd_recv.wz * LB_CENTER;
 116:application/chassis/chassis.c ****     // vt_rb = chassis_vx + chassis_vy - chassis_cmd_recv.wz * RB_CENTER;
 117:application/chassis/chassis.c ****     vt_lf = -chassis_vx - chassis_vy - chassis_cmd_recv.wz  ;
  33              		.loc 1 117 5 view .LVU1
  34              		.loc 1 117 13 is_stmt 0 view .LVU2
  35 0000 134B     		ldr	r3, .L2
  36 0002 D3ED007A 		vldr.32	s15, [r3]
  37 0006 B1EE677A 		vneg.f32	s14, s15
  38              		.loc 1 117 25 view .LVU3
  39 000a 124B     		ldr	r3, .L2+4
  40 000c 93ED006A 		vldr.32	s12, [r3]
  41 0010 37EE467A 		vsub.f32	s14, s14, s12
  42              		.loc 1 117 56 view .LVU4
  43 0014 104B     		ldr	r3, .L2+8
  44 0016 D3ED026A 		vldr.32	s13, [r3, #8]
  45              		.loc 1 117 38 view .LVU5
  46 001a 37EE667A 		vsub.f32	s14, s14, s13
  47              		.loc 1 117 11 view .LVU6
  48 001e 0F4B     		ldr	r3, .L2+12
  49 0020 83ED007A 		vstr.32	s14, [r3]
 118:application/chassis/chassis.c ****     vt_rf = -chassis_vx + chassis_vy - chassis_cmd_recv.wz ;
  50              		.loc 1 118 5 is_stmt 1 view .LVU7
  51              		.loc 1 118 25 is_stmt 0 view .LVU8
  52 0024 36EE677A 		vsub.f32	s14, s12, s15
  53              		.loc 1 118 38 view .LVU9
  54 0028 37EE667A 		vsub.f32	s14, s14, s13
ARM GAS  C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s 			page 4


  55              		.loc 1 118 11 view .LVU10
  56 002c 0C4B     		ldr	r3, .L2+16
  57 002e 83ED007A 		vstr.32	s14, [r3]
 119:application/chassis/chassis.c ****     vt_lb = chassis_vx - chassis_vy - chassis_cmd_recv.wz  ;
  58              		.loc 1 119 5 is_stmt 1 view .LVU11
  59              		.loc 1 119 24 is_stmt 0 view .LVU12
  60 0032 37EEC67A 		vsub.f32	s14, s15, s12
  61              		.loc 1 119 37 view .LVU13
  62 0036 37EE667A 		vsub.f32	s14, s14, s13
  63              		.loc 1 119 11 view .LVU14
  64 003a 0A4B     		ldr	r3, .L2+20
  65 003c 83ED007A 		vstr.32	s14, [r3]
 120:application/chassis/chassis.c ****     vt_rb = chassis_vx + chassis_vy - chassis_cmd_recv.wz ;
  66              		.loc 1 120 5 is_stmt 1 view .LVU15
  67              		.loc 1 120 24 is_stmt 0 view .LVU16
  68 0040 77EE867A 		vadd.f32	s15, s15, s12
  69              		.loc 1 120 37 view .LVU17
  70 0044 77EEE67A 		vsub.f32	s15, s15, s13
  71              		.loc 1 120 11 view .LVU18
  72 0048 074B     		ldr	r3, .L2+24
  73 004a C3ED007A 		vstr.32	s15, [r3]
 121:application/chassis/chassis.c **** }
  74              		.loc 1 121 1 view .LVU19
  75 004e 7047     		bx	lr
  76              	.L3:
  77              		.align	2
  78              	.L2:
  79 0050 00000000 		.word	chassis_vx
  80 0054 00000000 		.word	chassis_vy
  81 0058 00000000 		.word	chassis_cmd_recv
  82 005c 00000000 		.word	vt_lf
  83 0060 00000000 		.word	vt_rf
  84 0064 00000000 		.word	vt_lb
  85 0068 00000000 		.word	vt_rb
  86              		.cfi_endproc
  87              	.LFE168:
  89              		.section	.text.EstimateChassisAngle,"ax",%progbits
  90              		.align	1
  91              		.syntax unified
  92              		.thumb
  93              		.thumb_func
  95              	EstimateChassisAngle:
  96              	.LVL0:
  97              	.LFB170:
 122:application/chassis/chassis.c **** 
 123:application/chassis/chassis.c **** /**
 124:application/chassis/chassis.c ****  * @brief Ê†πÊçÆË£ÅÂà§Á≥ªÁªüÂíåÁîµÂÆπÂâ©‰ΩôÂÆπÈáèÂØπËæìÂá∫ËøõË°åÈôêÂà∂Âπ∂ËÆæÁΩÆÁîµÊú∫ÂèÇËÄÉÂÄº
 125:application/chassis/chassis.c ****  *
 126:application/chassis/chassis.c ****  */
 127:application/chassis/chassis.c **** static void LimitChassisOutput()
 128:application/chassis/chassis.c **** {
 129:application/chassis/chassis.c ****     // ÂäüÁéáÈôêÂà∂ÂæÖÊ∑ªÂä†
 130:application/chassis/chassis.c ****     // referee_data->PowerHeatData.chassis_power;
 131:application/chassis/chassis.c ****     // referee_data->PowerHeatData.chassis_power_buffer;
 132:application/chassis/chassis.c **** 
 133:application/chassis/chassis.c ****     // ÂÆåÊàêÂäüÁéáÈôêÂà∂ÂêéËøõË°åÁîµÊú∫ÂèÇËÄÉËæìÂÖ•ËÆæÂÆö
 134:application/chassis/chassis.c ****     DJIMotorSetRef(motor_lf, vt_lf);
ARM GAS  C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s 			page 5


 135:application/chassis/chassis.c ****     DJIMotorSetRef(motor_rf, vt_rf);
 136:application/chassis/chassis.c ****     DJIMotorSetRef(motor_lb, vt_lb);
 137:application/chassis/chassis.c ****     DJIMotorSetRef(motor_rb, vt_rb);
 138:application/chassis/chassis.c **** }
 139:application/chassis/chassis.c **** 
 140:application/chassis/chassis.c **** 
 141:application/chassis/chassis.c **** /**
 142:application/chassis/chassis.c ****  * @brief ÂØπÊéßÂà∂ÁöÑÂ∫ïÁõòËßíÂ∫¶ËøõË°åÁªìÁÆó
 143:application/chassis/chassis.c ****  *          
 144:application/chassis/chassis.c ****  *
 145:application/chassis/chassis.c ****  */
 146:application/chassis/chassis.c **** 
 147:application/chassis/chassis.c **** static void EstimateChassisAngle(PIDInstance *chassis_angle_pid,float angle_measure,float angle_ref
  98              		.loc 1 147 101 is_stmt 1 view -0
  99              		.cfi_startproc
 100              		@ args = 0, pretend = 0, frame = 0
 101              		@ frame_needed = 0, uses_anonymous_args = 0
 102              		.loc 1 147 101 is_stmt 0 view .LVU21
 103 0000 08B5     		push	{r3, lr}
 104              		.cfi_def_cfa_offset 8
 105              		.cfi_offset 3, -8
 106              		.cfi_offset 14, -4
 148:application/chassis/chassis.c ****         chassis_cmd_recv.wz= -1*PIDCalculate(chassis_angle_pid, angle_measure, angle_ref);
 107              		.loc 1 148 9 is_stmt 1 view .LVU22
 108              		.loc 1 148 33 is_stmt 0 view .LVU23
 109 0002 FFF7FEFF 		bl	PIDCalculate
 110              	.LVL1:
 111              		.loc 1 148 32 discriminator 1 view .LVU24
 112 0006 B1EE400A 		vneg.f32	s0, s0
 113              		.loc 1 148 28 discriminator 1 view .LVU25
 114 000a 024B     		ldr	r3, .L6
 115 000c 83ED020A 		vstr.32	s0, [r3, #8]
 149:application/chassis/chassis.c **** }
 116              		.loc 1 149 1 view .LVU26
 117 0010 08BD     		pop	{r3, pc}
 118              	.L7:
 119 0012 00BF     		.align	2
 120              	.L6:
 121 0014 00000000 		.word	chassis_cmd_recv
 122              		.cfi_endproc
 123              	.LFE170:
 125              		.section	.text.LimitChassisOutput,"ax",%progbits
 126              		.align	1
 127              		.syntax unified
 128              		.thumb
 129              		.thumb_func
 131              	LimitChassisOutput:
 132              	.LFB169:
 128:application/chassis/chassis.c ****     // ÂäüÁéáÈôêÂà∂ÂæÖÊ∑ªÂä†
 133              		.loc 1 128 1 is_stmt 1 view -0
 134              		.cfi_startproc
 135              		@ args = 0, pretend = 0, frame = 0
 136              		@ frame_needed = 0, uses_anonymous_args = 0
 137 0000 08B5     		push	{r3, lr}
 138              		.cfi_def_cfa_offset 8
 139              		.cfi_offset 3, -8
 140              		.cfi_offset 14, -4
ARM GAS  C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s 			page 6


 134:application/chassis/chassis.c ****     DJIMotorSetRef(motor_rf, vt_rf);
 141              		.loc 1 134 5 view .LVU28
 142 0002 0E4B     		ldr	r3, .L10
 143 0004 93ED000A 		vldr.32	s0, [r3]
 144 0008 0D4B     		ldr	r3, .L10+4
 145 000a 1868     		ldr	r0, [r3]
 146 000c FFF7FEFF 		bl	DJIMotorSetRef
 147              	.LVL2:
 135:application/chassis/chassis.c ****     DJIMotorSetRef(motor_lb, vt_lb);
 148              		.loc 1 135 5 view .LVU29
 149 0010 0C4B     		ldr	r3, .L10+8
 150 0012 93ED000A 		vldr.32	s0, [r3]
 151 0016 0C4B     		ldr	r3, .L10+12
 152 0018 1868     		ldr	r0, [r3]
 153 001a FFF7FEFF 		bl	DJIMotorSetRef
 154              	.LVL3:
 136:application/chassis/chassis.c ****     DJIMotorSetRef(motor_rb, vt_rb);
 155              		.loc 1 136 5 view .LVU30
 156 001e 0B4B     		ldr	r3, .L10+16
 157 0020 93ED000A 		vldr.32	s0, [r3]
 158 0024 0A4B     		ldr	r3, .L10+20
 159 0026 1868     		ldr	r0, [r3]
 160 0028 FFF7FEFF 		bl	DJIMotorSetRef
 161              	.LVL4:
 137:application/chassis/chassis.c **** }
 162              		.loc 1 137 5 view .LVU31
 163 002c 094B     		ldr	r3, .L10+24
 164 002e 93ED000A 		vldr.32	s0, [r3]
 165 0032 094B     		ldr	r3, .L10+28
 166 0034 1868     		ldr	r0, [r3]
 167 0036 FFF7FEFF 		bl	DJIMotorSetRef
 168              	.LVL5:
 138:application/chassis/chassis.c **** 
 169              		.loc 1 138 1 is_stmt 0 view .LVU32
 170 003a 08BD     		pop	{r3, pc}
 171              	.L11:
 172              		.align	2
 173              	.L10:
 174 003c 00000000 		.word	vt_lf
 175 0040 00000000 		.word	motor_lf
 176 0044 00000000 		.word	vt_rf
 177 0048 00000000 		.word	motor_rf
 178 004c 00000000 		.word	vt_lb
 179 0050 00000000 		.word	motor_lb
 180 0054 00000000 		.word	vt_rb
 181 0058 00000000 		.word	motor_rb
 182              		.cfi_endproc
 183              	.LFE169:
 185              		.section	.rodata.ChassisInit.str1.4,"aMS",%progbits,1
 186              		.align	2
 187              	.LC0:
 188 0000 63686173 		.ascii	"chassis_cmd\000"
 188      7369735F 
 188      636D6400 
 189              		.align	2
 190              	.LC1:
 191 000c 63686173 		.ascii	"chassis_feed\000"
ARM GAS  C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s 			page 7


 191      7369735F 
 191      66656564 
 191      00
 192              		.section	.text.ChassisInit,"ax",%progbits
 193              		.align	1
 194              		.global	ChassisInit
 195              		.syntax unified
 196              		.thumb
 197              		.thumb_func
 199              	ChassisInit:
 200              	.LFB167:
  30:application/chassis/chassis.c ****         chassis_angle_pid.Kp=30;
 201              		.loc 1 30 1 is_stmt 1 view -0
 202              		.cfi_startproc
 203              		@ args = 0, pretend = 0, frame = 176
 204              		@ frame_needed = 0, uses_anonymous_args = 0
 205 0000 70B5     		push	{r4, r5, r6, lr}
 206              		.cfi_def_cfa_offset 16
 207              		.cfi_offset 4, -16
 208              		.cfi_offset 5, -12
 209              		.cfi_offset 6, -8
 210              		.cfi_offset 14, -4
 211 0002 ACB0     		sub	sp, sp, #176
 212              		.cfi_def_cfa_offset 192
  31:application/chassis/chassis.c ****         chassis_angle_pid.Ki=2  ;   
 213              		.loc 1 31 9 view .LVU34
  31:application/chassis/chassis.c ****         chassis_angle_pid.Ki=2  ;   
 214              		.loc 1 31 29 is_stmt 0 view .LVU35
 215 0004 2C4B     		ldr	r3, .L14
 216 0006 2D4A     		ldr	r2, .L14+4
 217 0008 1A60     		str	r2, [r3]	@ float
  32:application/chassis/chassis.c ****         chassis_angle_pid.Kd=0.05;
 218              		.loc 1 32 9 is_stmt 1 view .LVU36
  32:application/chassis/chassis.c ****         chassis_angle_pid.Kd=0.05;
 219              		.loc 1 32 29 is_stmt 0 view .LVU37
 220 000a 4FF08042 		mov	r2, #1073741824
 221 000e 5A60     		str	r2, [r3, #4]	@ float
  33:application/chassis/chassis.c ****         chassis_angle_pid.IntegralLimit = 3000;
 222              		.loc 1 33 9 is_stmt 1 view .LVU38
  33:application/chassis/chassis.c ****         chassis_angle_pid.IntegralLimit = 3000;
 223              		.loc 1 33 29 is_stmt 0 view .LVU39
 224 0010 2B4A     		ldr	r2, .L14+8
 225 0012 9A60     		str	r2, [r3, #8]	@ float
  34:application/chassis/chassis.c ****         chassis_angle_pid.MaxOut = 12000;
 226              		.loc 1 34 9 is_stmt 1 view .LVU40
  34:application/chassis/chassis.c ****         chassis_angle_pid.MaxOut = 12000;
 227              		.loc 1 34 41 is_stmt 0 view .LVU41
 228 0014 2B4C     		ldr	r4, .L14+12
 229 0016 9C61     		str	r4, [r3, #24]	@ float
  35:application/chassis/chassis.c ****     // Âõõ‰∏™ËΩÆÂ≠êÁöÑÂèÇÊï∞‰∏ÄÊ†∑,Êîπtx_idÂíåÂèçËΩ¨Ê†áÂøó‰ΩçÂç≥ÂèØ
 230              		.loc 1 35 9 is_stmt 1 view .LVU42
  35:application/chassis/chassis.c ****     // Âõõ‰∏™ËΩÆÂ≠êÁöÑÂèÇÊï∞‰∏ÄÊ†∑,Êîπtx_idÂíåÂèçËΩ¨Ê†áÂøó‰ΩçÂç≥ÂèØ
 231              		.loc 1 35 34 is_stmt 0 view .LVU43
 232 0018 2B4D     		ldr	r5, .L14+16
 233 001a DD60     		str	r5, [r3, #12]	@ float
  37:application/chassis/chassis.c ****         .can_init_config.can_handle = &hcan1,
 234              		.loc 1 37 5 is_stmt 1 view .LVU44
ARM GAS  C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s 			page 8


  37:application/chassis/chassis.c ****         .can_init_config.can_handle = &hcan1,
 235              		.loc 1 37 25 is_stmt 0 view .LVU45
 236 001c B022     		movs	r2, #176
 237 001e 0021     		movs	r1, #0
 238 0020 6846     		mov	r0, sp
 239 0022 FFF7FEFF 		bl	memset
 240              	.LVL6:
 241 0026 4FF07C53 		mov	r3, #1056964608
 242 002a 0493     		str	r3, [sp, #16]	@ float
 243 002c 274B     		ldr	r3, .L14+20
 244 002e 0793     		str	r3, [sp, #28]	@ float
 245 0030 0723     		movs	r3, #7
 246 0032 8DF82430 		strb	r3, [sp, #36]
 247 0036 0A94     		str	r4, [sp, #40]	@ float
 248 0038 254A     		ldr	r2, .L14+24
 249 003a 0F92     		str	r2, [sp, #60]	@ float
 250 003c 1295     		str	r5, [sp, #72]	@ float
 251 003e 8DF85030 		strb	r3, [sp, #80]
 252 0042 1594     		str	r4, [sp, #84]	@ float
 253 0044 0225     		movs	r5, #2
 254 0046 8DF89450 		strb	r5, [sp, #148]
 255 004a 0326     		movs	r6, #3
 256 004c 8DF89560 		strb	r6, [sp, #149]
 257 0050 8DF89B50 		strb	r5, [sp, #155]
 258 0054 1F4B     		ldr	r3, .L14+28
 259 0056 2793     		str	r3, [sp, #156]
  66:application/chassis/chassis.c ****     chassis_motor_config.controller_setting_init_config.motor_reverse_flag = MOTOR_DIRECTION_REVERS
 260              		.loc 1 66 5 is_stmt 1 view .LVU46
  66:application/chassis/chassis.c ****     chassis_motor_config.controller_setting_init_config.motor_reverse_flag = MOTOR_DIRECTION_REVERS
 261              		.loc 1 66 48 is_stmt 0 view .LVU47
 262 0058 0124     		movs	r4, #1
 263 005a 2894     		str	r4, [sp, #160]
  67:application/chassis/chassis.c ****     motor_lf = DJIMotorInit(&chassis_motor_config);
 264              		.loc 1 67 5 is_stmt 1 view .LVU48
  67:application/chassis/chassis.c ****     motor_lf = DJIMotorInit(&chassis_motor_config);
 265              		.loc 1 67 76 is_stmt 0 view .LVU49
 266 005c 8DF89640 		strb	r4, [sp, #150]
  68:application/chassis/chassis.c **** 
 267              		.loc 1 68 5 is_stmt 1 view .LVU50
  68:application/chassis/chassis.c **** 
 268              		.loc 1 68 16 is_stmt 0 view .LVU51
 269 0060 6846     		mov	r0, sp
 270 0062 FFF7FEFF 		bl	DJIMotorInit
 271              	.LVL7:
  68:application/chassis/chassis.c **** 
 272              		.loc 1 68 14 discriminator 1 view .LVU52
 273 0066 1C4B     		ldr	r3, .L14+32
 274 0068 1860     		str	r0, [r3]
  70:application/chassis/chassis.c ****     chassis_motor_config.controller_setting_init_config.motor_reverse_flag = MOTOR_DIRECTION_REVERS
 275              		.loc 1 70 5 is_stmt 1 view .LVU53
  70:application/chassis/chassis.c ****     chassis_motor_config.controller_setting_init_config.motor_reverse_flag = MOTOR_DIRECTION_REVERS
 276              		.loc 1 70 48 is_stmt 0 view .LVU54
 277 006a 2895     		str	r5, [sp, #160]
  71:application/chassis/chassis.c ****     motor_rf = DJIMotorInit(&chassis_motor_config);
 278              		.loc 1 71 5 is_stmt 1 view .LVU55
  71:application/chassis/chassis.c ****     motor_rf = DJIMotorInit(&chassis_motor_config);
 279              		.loc 1 71 76 is_stmt 0 view .LVU56
ARM GAS  C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s 			page 9


 280 006c 8DF89640 		strb	r4, [sp, #150]
  72:application/chassis/chassis.c **** 
 281              		.loc 1 72 5 is_stmt 1 view .LVU57
  72:application/chassis/chassis.c **** 
 282              		.loc 1 72 16 is_stmt 0 view .LVU58
 283 0070 6846     		mov	r0, sp
 284 0072 FFF7FEFF 		bl	DJIMotorInit
 285              	.LVL8:
  72:application/chassis/chassis.c **** 
 286              		.loc 1 72 14 discriminator 1 view .LVU59
 287 0076 194B     		ldr	r3, .L14+36
 288 0078 1860     		str	r0, [r3]
  74:application/chassis/chassis.c ****     chassis_motor_config.controller_setting_init_config.motor_reverse_flag = MOTOR_DIRECTION_REVERS
 289              		.loc 1 74 5 is_stmt 1 view .LVU60
  74:application/chassis/chassis.c ****     chassis_motor_config.controller_setting_init_config.motor_reverse_flag = MOTOR_DIRECTION_REVERS
 290              		.loc 1 74 48 is_stmt 0 view .LVU61
 291 007a 0423     		movs	r3, #4
 292 007c 2893     		str	r3, [sp, #160]
  75:application/chassis/chassis.c ****     motor_lb = DJIMotorInit(&chassis_motor_config);
 293              		.loc 1 75 5 is_stmt 1 view .LVU62
  75:application/chassis/chassis.c ****     motor_lb = DJIMotorInit(&chassis_motor_config);
 294              		.loc 1 75 76 is_stmt 0 view .LVU63
 295 007e 8DF89640 		strb	r4, [sp, #150]
  76:application/chassis/chassis.c **** 
 296              		.loc 1 76 5 is_stmt 1 view .LVU64
  76:application/chassis/chassis.c **** 
 297              		.loc 1 76 16 is_stmt 0 view .LVU65
 298 0082 6846     		mov	r0, sp
 299 0084 FFF7FEFF 		bl	DJIMotorInit
 300              	.LVL9:
  76:application/chassis/chassis.c **** 
 301              		.loc 1 76 14 discriminator 1 view .LVU66
 302 0088 154B     		ldr	r3, .L14+40
 303 008a 1860     		str	r0, [r3]
  78:application/chassis/chassis.c ****     chassis_motor_config.controller_setting_init_config.motor_reverse_flag = MOTOR_DIRECTION_REVERS
 304              		.loc 1 78 5 is_stmt 1 view .LVU67
  78:application/chassis/chassis.c ****     chassis_motor_config.controller_setting_init_config.motor_reverse_flag = MOTOR_DIRECTION_REVERS
 305              		.loc 1 78 48 is_stmt 0 view .LVU68
 306 008c 2896     		str	r6, [sp, #160]
  79:application/chassis/chassis.c ****     motor_rb = DJIMotorInit(&chassis_motor_config);
 307              		.loc 1 79 5 is_stmt 1 view .LVU69
  79:application/chassis/chassis.c ****     motor_rb = DJIMotorInit(&chassis_motor_config);
 308              		.loc 1 79 76 is_stmt 0 view .LVU70
 309 008e 8DF89640 		strb	r4, [sp, #150]
  80:application/chassis/chassis.c **** 
 310              		.loc 1 80 5 is_stmt 1 view .LVU71
  80:application/chassis/chassis.c **** 
 311              		.loc 1 80 16 is_stmt 0 view .LVU72
 312 0092 6846     		mov	r0, sp
 313 0094 FFF7FEFF 		bl	DJIMotorInit
 314              	.LVL10:
  80:application/chassis/chassis.c **** 
 315              		.loc 1 80 14 discriminator 1 view .LVU73
 316 0098 124B     		ldr	r3, .L14+44
 317 009a 1860     		str	r0, [r3]
  99:application/chassis/chassis.c ****     chassis_pub = PubRegister("chassis_feed", sizeof(Chassis_Upload_Data_s));
 318              		.loc 1 99 5 is_stmt 1 view .LVU74
ARM GAS  C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s 			page 10


  99:application/chassis/chassis.c ****     chassis_pub = PubRegister("chassis_feed", sizeof(Chassis_Upload_Data_s));
 319              		.loc 1 99 19 is_stmt 0 view .LVU75
 320 009c 1921     		movs	r1, #25
 321 009e 1248     		ldr	r0, .L14+48
 322 00a0 FFF7FEFF 		bl	SubRegister
 323              	.LVL11:
  99:application/chassis/chassis.c ****     chassis_pub = PubRegister("chassis_feed", sizeof(Chassis_Upload_Data_s));
 324              		.loc 1 99 17 discriminator 1 view .LVU76
 325 00a4 114B     		ldr	r3, .L14+52
 326 00a6 1860     		str	r0, [r3]
 100:application/chassis/chassis.c **** #endif // ONE_BOARD
 327              		.loc 1 100 5 is_stmt 1 view .LVU77
 100:application/chassis/chassis.c **** #endif // ONE_BOARD
 328              		.loc 1 100 19 is_stmt 0 view .LVU78
 329 00a8 2146     		mov	r1, r4
 330 00aa 1148     		ldr	r0, .L14+56
 331 00ac FFF7FEFF 		bl	PubRegister
 332              	.LVL12:
 100:application/chassis/chassis.c **** #endif // ONE_BOARD
 333              		.loc 1 100 17 discriminator 1 view .LVU79
 334 00b0 104B     		ldr	r3, .L14+60
 335 00b2 1860     		str	r0, [r3]
 102:application/chassis/chassis.c **** #define LF_CENTER ((HALF_TRACK_WIDTH + CENTER_GIMBAL_OFFSET_X + HALF_WHEEL_BASE - CENTER_GIMBAL_OFF
 336              		.loc 1 102 1 view .LVU80
 337 00b4 2CB0     		add	sp, sp, #176
 338              		.cfi_def_cfa_offset 16
 339              		@ sp needed
 340 00b6 70BD     		pop	{r4, r5, r6, pc}
 341              	.L15:
 342              		.align	2
 343              	.L14:
 344 00b8 00000000 		.word	chassis_angle_pid
 345 00bc 0000F041 		.word	1106247680
 346 00c0 CDCC4C3D 		.word	1028443341
 347 00c4 00803B45 		.word	1161527296
 348 00c8 00803B46 		.word	1178304512
 349 00cc 00606A46 		.word	1181376512
 350 00d0 00002041 		.word	1092616192
 351 00d4 00000000 		.word	hcan1
 352 00d8 00000000 		.word	motor_lf
 353 00dc 00000000 		.word	motor_rf
 354 00e0 00000000 		.word	motor_lb
 355 00e4 00000000 		.word	motor_rb
 356 00e8 00000000 		.word	.LC0
 357 00ec 00000000 		.word	chassis_sub
 358 00f0 0C000000 		.word	.LC1
 359 00f4 00000000 		.word	chassis_pub
 360              		.cfi_endproc
 361              	.LFE167:
 363              		.section	.text.ChassisTask,"ax",%progbits
 364              		.align	1
 365              		.global	ChassisTask
 366              		.syntax unified
 367              		.thumb
 368              		.thumb_func
 370              	ChassisTask:
 371              	.LFB172:
ARM GAS  C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s 			page 11


 150:application/chassis/chassis.c **** 
 151:application/chassis/chassis.c **** /**
 152:application/chassis/chassis.c ****  * @brief Ê†πÊçÆÊØè‰∏™ËΩÆÂ≠êÁöÑÈÄüÂ∫¶ÂèçÈ¶à,ËÆ°ÁÆóÂ∫ïÁõòÁöÑÂÆûÈôÖËøêÂä®ÈÄüÂ∫¶,ÈÄÜËøêÂä®Ëß£ÁÆó
 153:application/chassis/chassis.c ****  *        ÂØπ‰∫éÂèåÊùøÁöÑÊÉÖÂÜµ,ËÄÉËôëÂ¢ûÂä†Êù•Ëá™Â∫ïÁõòÊùøIMUÁöÑÊï∞ÊçÆ
 154:application/chassis/chassis.c ****  *
 155:application/chassis/chassis.c ****  */
 156:application/chassis/chassis.c **** static void EstimateSpeed()
 157:application/chassis/chassis.c ****     // Ê†πÊçÆÁîµÊú∫ÈÄüÂ∫¶ÂíåÈôÄËû∫‰ª™ÁöÑËßíÈÄüÂ∫¶ËøõË°åËß£ÁÆó,ËøòÂèØ‰ª•Âà©Áî®Âä†ÈÄüÂ∫¶ËÆ°Âà§Êñ≠ÊòØÂ
 158:application/chassis/chassis.c **** {
 159:application/chassis/chassis.c ****     // chassis_feedback_data.vx vy wz =
 160:application/chassis/chassis.c ****     //  ...
 161:application/chassis/chassis.c **** }
 162:application/chassis/chassis.c **** 
 163:application/chassis/chassis.c **** /* Êú∫Âô®‰∫∫Â∫ïÁõòÊéßÂà∂Ê†∏ÂøÉ‰ªªÂä° */
 164:application/chassis/chassis.c **** void ChassisTask()
 165:application/chassis/chassis.c **** {
 372              		.loc 1 165 1 is_stmt 1 view -0
 373              		.cfi_startproc
 374              		@ args = 0, pretend = 0, frame = 0
 375              		@ frame_needed = 0, uses_anonymous_args = 0
 376 0000 10B5     		push	{r4, lr}
 377              		.cfi_def_cfa_offset 8
 378              		.cfi_offset 4, -8
 379              		.cfi_offset 14, -4
 166:application/chassis/chassis.c ****     // ÂêéÁª≠Â¢ûÂä†Ê≤°Êî∂Âà∞Ê∂àÊÅØÁöÑÂ§ÑÁêÜ(ÂèåÊùøÁöÑÊÉÖÂÜµ)
 167:application/chassis/chassis.c ****     // Ëé∑ÂèñÊñ∞ÁöÑÊéßÂà∂‰ø°ÊÅØ
 168:application/chassis/chassis.c **** #ifdef ONE_BOARD
 169:application/chassis/chassis.c ****     SubGetMessage(chassis_sub, &chassis_cmd_recv);
 380              		.loc 1 169 5 view .LVU82
 381 0002 274C     		ldr	r4, .L20
 382 0004 2146     		mov	r1, r4
 383 0006 274B     		ldr	r3, .L20+4
 384 0008 1868     		ldr	r0, [r3]
 385 000a FFF7FEFF 		bl	SubGetMessage
 386              	.LVL13:
 170:application/chassis/chassis.c **** #endif   
 171:application/chassis/chassis.c **** #ifdef CHASSIS_BOARD
 172:application/chassis/chassis.c ****     chassis_cmd_recv = *(Chassis_Ctrl_Cmd_s *)CANCommGet(chasiss_can_comm);
 173:application/chassis/chassis.c **** #endif // CHASSIS_BOARD
 174:application/chassis/chassis.c **** 
 175:application/chassis/chassis.c ****     if (chassis_cmd_recv.chassis_mode == CHASSIS_ZERO_FORCE)
 387              		.loc 1 175 5 view .LVU83
 388              		.loc 1 175 25 is_stmt 0 view .LVU84
 389 000e 237D     		ldrb	r3, [r4, #20]	@ zero_extendqisi2
 390              		.loc 1 175 8 view .LVU85
 391 0010 002B     		cmp	r3, #0
 392 0012 34D1     		bne	.L17
 176:application/chassis/chassis.c ****     { // Â¶ÇÊûúÂá∫Áé∞ÈáçË¶ÅÊ®°ÂùóÁ¶ªÁ∫øÊàñÈÅ•ÊéßÂô®ËÆæÁΩÆ‰∏∫ÊÄ•ÂÅú,ËÆ©ÁîµÊú∫ÂÅúÊ≠¢
 177:application/chassis/chassis.c ****         DJIMotorStop(motor_lf);
 393              		.loc 1 177 9 is_stmt 1 view .LVU86
 394 0014 244B     		ldr	r3, .L20+8
 395 0016 1868     		ldr	r0, [r3]
 396 0018 FFF7FEFF 		bl	DJIMotorStop
 397              	.LVL14:
 178:application/chassis/chassis.c ****         DJIMotorStop(motor_rf);
 398              		.loc 1 178 9 view .LVU87
 399 001c 234B     		ldr	r3, .L20+12
ARM GAS  C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s 			page 12


 400 001e 1868     		ldr	r0, [r3]
 401 0020 FFF7FEFF 		bl	DJIMotorStop
 402              	.LVL15:
 179:application/chassis/chassis.c ****         DJIMotorStop(motor_lb);
 403              		.loc 1 179 9 view .LVU88
 404 0024 224B     		ldr	r3, .L20+16
 405 0026 1868     		ldr	r0, [r3]
 406 0028 FFF7FEFF 		bl	DJIMotorStop
 407              	.LVL16:
 180:application/chassis/chassis.c ****         DJIMotorStop(motor_rb);
 408              		.loc 1 180 9 view .LVU89
 409 002c 214B     		ldr	r3, .L20+20
 410 002e 1868     		ldr	r0, [r3]
 411 0030 FFF7FEFF 		bl	DJIMotorStop
 412              	.LVL17:
 413              	.L18:
 181:application/chassis/chassis.c ****     }
 182:application/chassis/chassis.c ****     else
 183:application/chassis/chassis.c ****     { // Ê≠£Â∏∏Â∑•‰Ωú
 184:application/chassis/chassis.c ****         DJIMotorEnable(motor_lf);
 185:application/chassis/chassis.c ****         DJIMotorEnable(motor_rf);
 186:application/chassis/chassis.c ****         DJIMotorEnable(motor_lb);
 187:application/chassis/chassis.c ****         DJIMotorEnable(motor_rb);
 188:application/chassis/chassis.c ****     }
 189:application/chassis/chassis.c **** 
 190:application/chassis/chassis.c ****     // Ê†πÊçÆÊéßÂà∂Ê®°ÂºèËÆæÂÆöÊóãËΩ¨ÈÄüÂ∫¶
 191:application/chassis/chassis.c ****     // switch (chassis_cmd_recv.chassis_mode)
 192:application/chassis/chassis.c ****     // {
 193:application/chassis/chassis.c ****     // case CHASSIS_NO_FOLLOW: // Â∫ïÁõò‰∏çÊóãËΩ¨,‰ΩÜÁª¥ÊåÅÂÖ®ÂêëÊú∫Âä®,‰∏ÄËà¨Áî®‰∫éË∞ÉÊï¥‰∫ëÂè∞Âßø
 194:application/chassis/chassis.c ****     //     chassis_cmd_recv.wz = 0;
 195:application/chassis/chassis.c ****     //     break;
 196:application/chassis/chassis.c ****     // case CHASSIS_FOLLOW_GIMBAL_YAW: // Ë∑üÈöè‰∫ëÂè∞,‰∏çÂçïÁã¨ËÆæÁΩÆpid,‰ª•ËØØÂ∑ÆËßíÂ∫¶Âπ≥Êñπ‰∏∫È
 197:application/chassis/chassis.c ****     //     chassis_cmd_recv.wz = -1.5f * chassis_cmd_recv.offset_angle * abs(chassis_cmd_recv.offse
 198:application/chassis/chassis.c ****     //     break;
 199:application/chassis/chassis.c ****     // case CHASSIS_ROTATE: // Ëá™Êóã,ÂêåÊó∂‰øùÊåÅÂÖ®ÂêëÊú∫Âä®;ÂΩìÂâçwzÁª¥ÊåÅÂÆöÂÄº,ÂêéÁª≠Â¢ûÂä†‰∏ç
 200:application/chassis/chassis.c ****     //     chassis_cmd_recv.wz = 4000;
 201:application/chassis/chassis.c ****     //     break;
 202:application/chassis/chassis.c ****     // default:
 203:application/chassis/chassis.c ****     //     break;
 204:application/chassis/chassis.c ****     // }
 205:application/chassis/chassis.c ****     // if((90-abs(INS.Yaw))>30){----Â∫ïÁõòËΩ¨90¬∞
 206:application/chassis/chassis.c **** 
 207:application/chassis/chassis.c ****     // }else
 208:application/chassis/chassis.c ****     // {intergal=intergal+(90-abs(INS.Yaw));}
 209:application/chassis/chassis.c ****     // chassis_cmd_recv.wz=(90-abs(INS.Yaw))*10+intergal*0.05;
 210:application/chassis/chassis.c ****     // chassis_cmd_recv.wz=PIDCalculate(&chassis_angle_pid, INS.Yaw,90);
 211:application/chassis/chassis.c ****     EstimateChassisAngle(&chassis_angle_pid,INS.total_angle,90);
 414              		.loc 1 211 5 view .LVU90
 415 0034 DFED200A 		vldr.32	s1, .L20+24
 416 0038 204B     		ldr	r3, .L20+28
 417 003a 93ED200A 		vldr.32	s0, [r3, #128]
 418 003e 2048     		ldr	r0, .L20+32
 419 0040 FFF7FEFF 		bl	EstimateChassisAngle
 420              	.LVL18:
 212:application/chassis/chassis.c ****     chassis_vx=3.0*chassis_cmd_recv.vy;
 421              		.loc 1 212 5 view .LVU91
 422              		.loc 1 212 36 is_stmt 0 view .LVU92
ARM GAS  C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s 			page 13


 423 0044 164B     		ldr	r3, .L20
 424 0046 D3ED017A 		vldr.32	s15, [r3, #4]
 425              		.loc 1 212 19 view .LVU93
 426 004a B0EE087A 		vmov.f32	s14, #3.0e+0
 427 004e 67EE877A 		vmul.f32	s15, s15, s14
 428              		.loc 1 212 15 view .LVU94
 429 0052 1C4A     		ldr	r2, .L20+36
 430 0054 C2ED007A 		vstr.32	s15, [r2]
 213:application/chassis/chassis.c ****     chassis_vy=-3.0*chassis_cmd_recv.vx;
 431              		.loc 1 213 5 is_stmt 1 view .LVU95
 432              		.loc 1 213 37 is_stmt 0 view .LVU96
 433 0058 D3ED007A 		vldr.32	s15, [r3]
 434              		.loc 1 213 20 view .LVU97
 435 005c B8EE087A 		vmov.f32	s14, #-3.0e+0
 436 0060 67EE877A 		vmul.f32	s15, s15, s14
 437              		.loc 1 213 15 view .LVU98
 438 0064 184B     		ldr	r3, .L20+40
 439 0066 C3ED007A 		vstr.32	s15, [r3]
 214:application/chassis/chassis.c ****     // chassis_wz=chassis_cmd_recv.wz;
 215:application/chassis/chassis.c ****     //  chassis_cmd_recv.wz=0;
 216:application/chassis/chassis.c ****     // Ê†πÊçÆ‰∫ëÂè∞ÂíåÂ∫ïÁõòÁöÑËßíÂ∫¶offsetÂ∞ÜÊéßÂà∂ÈáèÊò†Â∞ÑÂà∞Â∫ïÁõòÂùêÊ†áÁ≥ª‰∏ä
 217:application/chassis/chassis.c ****     // Â∫ïÁõòÈÄÜÊó∂ÈíàÊóãËΩ¨‰∏∫ËßíÂ∫¶Ê≠£ÊñπÂêë;‰∫ëÂè∞ÂëΩ‰ª§ÁöÑÊñπÂêë‰ª•‰∫ëÂè∞ÊåáÂêëÁöÑÊñπÂêë‰∏∫x,Èá
 218:application/chassis/chassis.c ****     // static float sin_theta, cos_theta;
 219:application/chassis/chassis.c ****     // cos_theta = arm_cos_f32(chassis_cmd_recv.offset_angle * DEGREE_2_RAD);
 220:application/chassis/chassis.c ****     // sin_theta = arm_sin_f32(chassis_cmd_recv.offset_angle * DEGREE_2_RAD);
 221:application/chassis/chassis.c ****     // chassis_vx = chassis_cmd_recv.vx * cos_theta - chassis_cmd_recv.vy * sin_theta;
 222:application/chassis/chassis.c ****     // chassis_vy = chassis_cmd_recv.vx * sin_theta + chassis_cmd_recv.vy * cos_theta;
 223:application/chassis/chassis.c ****     
 224:application/chassis/chassis.c **** 
 225:application/chassis/chassis.c ****     // Ê†πÊçÆÊéßÂà∂Ê®°ÂºèËøõË°åÊ≠£ËøêÂä®Â≠¶Ëß£ÁÆó,ËÆ°ÁÆóÂ∫ïÁõòËæìÂá∫
 226:application/chassis/chassis.c ****     MecanumCalculate();
 440              		.loc 1 226 5 is_stmt 1 view .LVU99
 441 006a FFF7FEFF 		bl	MecanumCalculate
 442              	.LVL19:
 227:application/chassis/chassis.c **** 
 228:application/chassis/chassis.c ****     // Ê†πÊçÆË£ÅÂà§Á≥ªÁªüÁöÑÂèçÈ¶àÊï∞ÊçÆÂíåÁîµÂÆπÊï∞ÊçÆÂØπËæìÂá∫ÈôêÂπÖÂπ∂ËÆæÂÆöÈó≠ÁéØÂèÇËÄÉÂÄº
 229:application/chassis/chassis.c ****     LimitChassisOutput();
 443              		.loc 1 229 5 view .LVU100
 444 006e FFF7FEFF 		bl	LimitChassisOutput
 445              	.LVL20:
 230:application/chassis/chassis.c **** 
 231:application/chassis/chassis.c ****     // Ê†πÊçÆÁîµÊú∫ÁöÑÂèçÈ¶àÈÄüÂ∫¶ÂíåIMU(Â¶ÇÊûúÊúâ)ËÆ°ÁÆóÁúüÂÆûÈÄüÂ∫¶
 232:application/chassis/chassis.c ****     EstimateSpeed();
 446              		.loc 1 232 5 view .LVU101
 233:application/chassis/chassis.c **** 
 234:application/chassis/chassis.c ****     // // Ëé∑ÂèñË£ÅÂà§Á≥ªÁªüÊï∞ÊçÆ   Âª∫ËÆÆÂ∞ÜË£ÅÂà§Á≥ªÁªü‰∏éÂ∫ïÁõòÂàÜÁ¶ªÔºåÊâÄ‰ª•Ê≠§Â§ÑÊï∞ÊçÆÂ∫î‰Ω
 235:application/chassis/chassis.c ****     // // ÊàëÊñπÈ¢úËâ≤idÂ∞è‰∫é7ÊòØÁ∫¢Ëâ≤,Â§ß‰∫é7ÊòØËìùËâ≤,Ê≥®ÊÑèËøôÈáåÂèëÈÄÅÁöÑÊòØÂØπÊñπÁöÑÈ¢úËâ≤, 
 236:application/chassis/chassis.c ****     // chassis_feedback_data.enemy_color = referee_data->GameRobotState.robot_id > 7 ? 1 : 0;
 237:application/chassis/chassis.c ****     // // ÂΩìÂâçÂè™ÂÅö‰∫Ü17mmÁÉ≠ÈáèÁöÑÊï∞ÊçÆËé∑Âèñ,ÂêéÁª≠Ê†πÊçÆrobot_def‰∏≠ÁöÑÂÆèÂàáÊç¢ÂèåÊû™ÁÆ°Âíå
 238:application/chassis/chassis.c ****     // chassis_feedback_data.bullet_speed = referee_data->GameRobotState.shooter_id1_17mm_speed_lim
 239:application/chassis/chassis.c ****     // chassis_feedback_data.rest_heat = referee_data->PowerHeatData.shooter_heat0;
 240:application/chassis/chassis.c **** 
 241:application/chassis/chassis.c ****     // Êé®ÈÄÅÂèçÈ¶àÊ∂àÊÅØ
 242:application/chassis/chassis.c **** #ifdef ONE_BOARD
 243:application/chassis/chassis.c ****     PubPushMessage(chassis_pub, (void *)&chassis_feedback_data);
 447              		.loc 1 243 5 view .LVU102
 448 0072 1649     		ldr	r1, .L20+44
ARM GAS  C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s 			page 14


 449 0074 164B     		ldr	r3, .L20+48
 450 0076 1868     		ldr	r0, [r3]
 451 0078 FFF7FEFF 		bl	PubPushMessage
 452              	.LVL21:
 244:application/chassis/chassis.c **** #endif
 245:application/chassis/chassis.c **** #ifdef CHASSIS_BOARD
 246:application/chassis/chassis.c ****     CANCommSend(chasiss_can_comm, (void *)&chassis_feedback_data);
 247:application/chassis/chassis.c **** #endif // CHASSIS_BOARD
 248:application/chassis/chassis.c **** }...
 453              		.loc 1 248 1 is_stmt 0 view .LVU103
 454 007c 10BD     		pop	{r4, pc}
 455              	.L17:
 184:application/chassis/chassis.c ****         DJIMotorEnable(motor_lf);
 456              		.loc 1 184 9 is_stmt 1 view .LVU104
 457 007e 0A4B     		ldr	r3, .L20+8
 458 0080 1868     		ldr	r0, [r3]
 459 0082 FFF7FEFF 		bl	DJIMotorEnable
 460              	.LVL22:
 185:application/chassis/chassis.c ****         DJIMotorEnable(motor_rf);
 461              		.loc 1 185 9 view .LVU105
 462 0086 094B     		ldr	r3, .L20+12
 463 0088 1868     		ldr	r0, [r3]
 464 008a FFF7FEFF 		bl	DJIMotorEnable
 465              	.LVL23:
 186:application/chassis/chassis.c ****         DJIMotorEnable(motor_lb);
 466              		.loc 1 186 9 view .LVU106
 467 008e 084B     		ldr	r3, .L20+16
 468 0090 1868     		ldr	r0, [r3]
 469 0092 FFF7FEFF 		bl	DJIMotorEnable
 470              	.LVL24:
 187:application/chassis/chassis.c ****         DJIMotorEnable(motor_rb);
 471              		.loc 1 187 9 view .LVU107
 472 0096 074B     		ldr	r3, .L20+20
 473 0098 1868     		ldr	r0, [r3]
 474 009a FFF7FEFF 		bl	DJIMotorEnable
 475              	.LVL25:
 476 009e C9E7     		b	.L18
 477              	.L21:
 478              		.align	2
 479              	.L20:
 480 00a0 00000000 		.word	chassis_cmd_recv
 481 00a4 00000000 		.word	chassis_sub
 482 00a8 00000000 		.word	motor_lf
 483 00ac 00000000 		.word	motor_rf
 484 00b0 00000000 		.word	motor_lb
 485 00b4 00000000 		.word	motor_rb
 486 00b8 0000B442 		.word	1119092736
 487 00bc 00000000 		.word	INS
 488 00c0 00000000 		.word	chassis_angle_pid
 489 00c4 00000000 		.word	chassis_vx
 490 00c8 00000000 		.word	chassis_vy
 491 00cc 00000000 		.word	chassis_feedback_data
 492 00d0 00000000 		.word	chassis_pub
 493              		.cfi_endproc
 494              	.LFE172:
 496              		.section	.bss.motor_rb,"aw",%nobits
 497              		.align	2
ARM GAS  C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s 			page 15


 500              	motor_rb:
 501 0000 00000000 		.space	4
 502              		.section	.bss.motor_lb,"aw",%nobits
 503              		.align	2
 506              	motor_lb:
 507 0000 00000000 		.space	4
 508              		.section	.bss.motor_rf,"aw",%nobits
 509              		.align	2
 512              	motor_rf:
 513 0000 00000000 		.space	4
 514              		.section	.bss.motor_lf,"aw",%nobits
 515              		.align	2
 518              	motor_lf:
 519 0000 00000000 		.space	4
 520              		.section	.bss.chassis_angle_pid,"aw",%nobits
 521              		.align	3
 524              	chassis_angle_pid:
 525 0000 00000000 		.space	120
 525      00000000 
 525      00000000 
 525      00000000 
 525      00000000 
 526              		.section	.bss.chassis_feedback_data,"aw",%nobits
 527              		.align	2
 530              	chassis_feedback_data:
 531 0000 00       		.space	1
 532              		.section	.bss.chassis_cmd_recv,"aw",%nobits
 533              		.align	2
 536              	chassis_cmd_recv:
 537 0000 00000000 		.space	25
 537      00000000 
 537      00000000 
 537      00000000 
 537      00000000 
 538              		.section	.bss.chassis_sub,"aw",%nobits
 539              		.align	2
 542              	chassis_sub:
 543 0000 00000000 		.space	4
 544              		.section	.bss.chassis_pub,"aw",%nobits
 545              		.align	2
 548              	chassis_pub:
 549 0000 00000000 		.space	4
 550              		.section	.bss.vt_rb,"aw",%nobits
 551              		.align	2
 554              	vt_rb:
 555 0000 00000000 		.space	4
 556              		.section	.bss.vt_lb,"aw",%nobits
 557              		.align	2
 560              	vt_lb:
 561 0000 00000000 		.space	4
 562              		.section	.bss.vt_rf,"aw",%nobits
 563              		.align	2
 566              	vt_rf:
 567 0000 00000000 		.space	4
 568              		.section	.bss.vt_lf,"aw",%nobits
 569              		.align	2
 572              	vt_lf:
ARM GAS  C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s 			page 16


 573 0000 00000000 		.space	4
 574              		.section	.bss.chassis_vy,"aw",%nobits
 575              		.align	2
 578              	chassis_vy:
 579 0000 00000000 		.space	4
 580              		.section	.bss.chassis_vx,"aw",%nobits
 581              		.align	2
 584              	chassis_vx:
 585 0000 00000000 		.space	4
 586              		.text
 587              	.Letext0:
 588              		.file 2 "C:/Users/Sive/AppData/Roaming/Code/User/globalStorage/bmd.stm32-for-vscode/@xpack-dev-too
 589              		.file 3 "C:/Users/Sive/AppData/Roaming/Code/User/globalStorage/bmd.stm32-for-vscode/@xpack-dev-too
 590              		.file 4 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/stm32f407xx.h"
 591              		.file 5 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/stm32f4xx.h"
 592              		.file 6 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_can.h"
 593              		.file 7 "moudels/imu/INS_task.h"
 594              		.file 8 "application/robot_def.h"
 595              		.file 9 "bsp/can/bsp_can.h"
 596              		.file 10 "moudels/algorithm/controller.h"
 597              		.file 11 "moudels/motor/motor_def.h"
 598              		.file 12 "moudels/daemon/daemon.h"
 599              		.file 13 "moudels/motor/DJImotor/dji_motor.h"
 600              		.file 14 "moudels/message_center/message_center.h"
 601              		.file 15 "Core/Inc/can.h"
 602              		.file 16 "<built-in>"
ARM GAS  C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s 			page 17


DEFINED SYMBOLS
                            *ABS*:00000000 chassis.c
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:21     .text.MecanumCalculate:00000000 $t
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:26     .text.MecanumCalculate:00000000 MecanumCalculate
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:79     .text.MecanumCalculate:00000050 $d
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:584    .bss.chassis_vx:00000000 chassis_vx
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:578    .bss.chassis_vy:00000000 chassis_vy
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:536    .bss.chassis_cmd_recv:00000000 chassis_cmd_recv
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:572    .bss.vt_lf:00000000 vt_lf
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:566    .bss.vt_rf:00000000 vt_rf
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:560    .bss.vt_lb:00000000 vt_lb
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:554    .bss.vt_rb:00000000 vt_rb
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:90     .text.EstimateChassisAngle:00000000 $t
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:95     .text.EstimateChassisAngle:00000000 EstimateChassisAngle
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:121    .text.EstimateChassisAngle:00000014 $d
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:126    .text.LimitChassisOutput:00000000 $t
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:131    .text.LimitChassisOutput:00000000 LimitChassisOutput
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:174    .text.LimitChassisOutput:0000003c $d
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:518    .bss.motor_lf:00000000 motor_lf
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:512    .bss.motor_rf:00000000 motor_rf
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:506    .bss.motor_lb:00000000 motor_lb
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:500    .bss.motor_rb:00000000 motor_rb
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:186    .rodata.ChassisInit.str1.4:00000000 $d
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:193    .text.ChassisInit:00000000 $t
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:199    .text.ChassisInit:00000000 ChassisInit
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:344    .text.ChassisInit:000000b8 $d
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:524    .bss.chassis_angle_pid:00000000 chassis_angle_pid
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:542    .bss.chassis_sub:00000000 chassis_sub
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:548    .bss.chassis_pub:00000000 chassis_pub
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:364    .text.ChassisTask:00000000 $t
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:370    .text.ChassisTask:00000000 ChassisTask
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:480    .text.ChassisTask:000000a0 $d
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:530    .bss.chassis_feedback_data:00000000 chassis_feedback_data
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:497    .bss.motor_rb:00000000 $d
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:503    .bss.motor_lb:00000000 $d
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:509    .bss.motor_rf:00000000 $d
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:515    .bss.motor_lf:00000000 $d
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:521    .bss.chassis_angle_pid:00000000 $d
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:527    .bss.chassis_feedback_data:00000000 $d
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:533    .bss.chassis_cmd_recv:00000000 $d
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:539    .bss.chassis_sub:00000000 $d
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:545    .bss.chassis_pub:00000000 $d
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:551    .bss.vt_rb:00000000 $d
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:557    .bss.vt_lb:00000000 $d
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:563    .bss.vt_rf:00000000 $d
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:569    .bss.vt_lf:00000000 $d
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:575    .bss.chassis_vy:00000000 $d
C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s:581    .bss.chassis_vx:00000000 $d

UNDEFINED SYMBOLS
PIDCalculate
DJIMotorSetRef
memset
DJIMotorInit
SubRegister
PubRegister
hcan1
ARM GAS  C:\Users\Sive\AppData\Local\Temp\ccTuQqrJ.s 			page 18


SubGetMessage
DJIMotorStop
PubPushMessage
DJIMotorEnable
INS
